
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Genesys Messaging Minimal (Append Responses)</title>
  <style>
    #log { width: 100%; height: 150px; }
  </style>
</head>
<body>
  <h3>Send a Message</h3>
  <input id="msgInput" type="text" placeholder="Type your message">
  <button onclick="sendMessage()">Send</button>
  
  <h3>Subscribe to Messages</h3>  <title>Genesys Subscribe Button</title>
  <button onclick="subscribeMessages()">Start Listening</button>

  <h3>Responses</h3>
  <textarea id="log" readonly placeholder="Inbound messages will appear here"></textarea>

  <script>
    // Load Genesys Web Messenger (adjust region/environment/deploymentId if needed)
    (function (g, e, n, es, ys) {
      g['_genesysJs'] = e;
      g[e] = g[e] || function () { (g[e].q = g[e].q || []).push(arguments); };
      g[e].t = 1 * new Date();
      g[e].c = es;
      ys = document.createElement('script');
      ys.async = 1;
      ys.src = n;
      ys.charset = 'utf-8';
      document.head.appendChild(ys);
    })(window, 'Genesys', 'https://apps.mypurecloud.jp/genesys-bootstrap/genesys.min.js', {
      environment: 'prod-apne1',
      deploymentId: 'be7b456d-7625-4f4f-83b3-ed30ebf47cc2'
    });

    function appendToLog(line) {
      const box = document.getElementById('log');
      box.value += (box.value ? "\n" : "") + line;
      box.scrollTop = box.scrollHeight; // auto-scroll to bottom
    }

    // Send message from input box
    function sendMessage() {
      const text = document.getElementById('msgInput').value.trim();
      if (!text) return;
      Genesys("command", "MessagingService.sendMessage", { message: text });
      appendToLog("You: " + text);
      document.getElementById('msgInput').value = "";
    }


    function subscribeMessages() {
      Genesys("subscribe", "MessagingService.messagesReceived", function({ data }) {
        console.log("Inbound message data:", data);
      });
      console.log("Subscription added. Check console for incoming messages.");
    }

  </script>
</body>
