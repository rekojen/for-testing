<!DOCTYPE html>
<html>
<body>
<h1>Hello World</h1>
<p>I'm hosted with GitHub Pages.</p>
<p>Genesys Cloud Web Messenger</p>
</body>

<h2>Send a Message</h2>
<input id="msgInput" type="text" placeholder="Type your message">
<button onclick="sendMessage()">Send</button>


<h3>Response</h3>
<textarea id="responseBox" rows="4" cols="50" readonly placeholder="Inbound messages will appear here"></textarea>


<script type="text/javascript" charset="utf-8">
  (function (g, e, n, es, ys) {
    g['_genesysJs'] = e;
    g[e] = g[e] || function () {
      (g[e].q = g[e].q || []).push(arguments)
    };
    g[e].t = 1 * new Date();
    g[e].c = es;
    ys = document.createElement('script'); ys.async = 1; ys.src = n; ys.charset = 'utf-8'; document.head.appendChild(ys);
  })(window, 'Genesys', 'https://apps.mypurecloud.jp/genesys-bootstrap/genesys.min.js', {
    environment: 'prod-apne1',
    deploymentId: 'be7b456d-7625-4f4f-83b3-ed30ebf47cc2'
  });
  
  
    function sendMessage() {
      const text = document.getElementById('msgInput').value;
      Genesys("command", "MessagingService.sendMessage", { message: text });
    }
	
	
Genesys("subscribe", "MessagingService.messagesReceived", function (evt) {
      const box = document.getElementById('responseBox');
      if (Array.isArray(evt?.messages) && evt.messages.length) {
        const last = evt.messages[evt.messages.length - 1];
        const text = last?.text || JSON.stringify(last);
        box.value = text;
      } else {
        box.value = "Message received (no text payload).";
      }
    });


</script>   
</html>
