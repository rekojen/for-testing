
<script>
  function sendMessage() {
    const el = document.getElementById('msgInput');
    const text = el.value.trim();
    if (!text) return;

    // Send without appending locally
    Genesys("command", "MessagingService.sendMessage", {
      message: { text } // recommended payload shape
    });

    el.value = "";
    el.focus();
  }

  Genesys("subscribe", "MessagingService.messagesReceived", function({ data }) {
    const msgs = Array.isArray(data?.messages) ? data.messages : [];
    msgs.forEach(m => {
      // Only render when there's text
      if (typeof m?.text === 'string' && m.text.length > 0) {
        // Optional: show who sent it based on direction
        const prefix = m?.direction === 'Outbound' ? 'Agent' :
                       m?.direction === 'Inbound' ? 'You' : 'Message';
        append((prefix ? (prefix + ': ') : '') + m.text);
      }
    });
  });
</
